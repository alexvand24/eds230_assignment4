---
title: "EDS230 Assignment 4"
author: "Charles Hendrickson, Ryan Munnikhuis, Alex Vand"
date: "4/21/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE, 
                      warning = FALSE)

library(tidyverse)
library(here)
library(pse)

#read in the atmospheric_conductance R script in order to use the function in this RMD 
source(here("atmospheric_conductance.R"))
```




```{r}
# Q2
atmospheric_conductance(v_m = 250, h = 1000)
```


```{r}
factors = c("v_m", "h", "k_d", "k_0")
```

```{r}
# number of parameter sets to run
nsets = 100
```

```{r}
q = c("qnorm", "qunif", "qnorm", "qnorm")
q_arg = list(list(mean = 250, sd = 30),    # v_m (cm/s)
             list(min = 950, max = 1050),  # h   (cm)
             list(mean = 0.7, sd = 0.01),  # k_d
             list(mean = 0.1, sd = 0.01))  # k_0
             
```


(a) Use LHS to generate parameter values for the 4 parameters.

```{r}
sens_atmospheric_conductance = LHS(NULL, factors, nsets, q, q_arg)
sens_pars = get.data(sens_atmospheric_conductance)
head(sens_pars)
```

(b) Run you atmospheric conductance model for these parameters and return aerodynamic conductances.

```{r}
# lets now run our model for all of the parameters generated by LHS
# pmap is useful here - it is a map function that uses the actual names of input parameters

yields <- sens_pars %>% pmap(atmospheric_conductance)

# notice that what pmap returns is a list 
head(yields)
```












